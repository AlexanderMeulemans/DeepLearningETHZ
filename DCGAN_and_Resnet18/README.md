
1)
Provided files: the full dataset from https://www.kaggle.com/c/painter-by-numbers/data and the corresponding csv file with labels train_info

The aim of the following two files is to select specific style- images with their corresponding labels in csv format

Creata a directory data_info_files in you current directory, to store all csv info files about the data and labels

-make_reduced_datafile.py: takes a csv file with artist, style and file name information as input and outputs a csv file with the same data for a subset of styles only (these can be freely chosen in the "look_for" list).

To run it: python make_reduced_datafile.py --inputfile './data_info_files/train_info.csv' --outpufile './data_info_files/reduced_train_info.csv'


-make_subselection_data.py takes an input file with images corresponding to the information csv file described above and outputs a file with images corresponding to the output info file of the above program.

To run it: python make_subselection_data.py --inputdir train --outputdir train_reduced

######dire qui doit etre dans data/ et data_info_file/


2)
DCGAN part:

Create a "data" directory in the current directory. The output of the following program should be in this folder.

-classical_data_augmentation.py: does preprocessing in order to get enough data for training the GAN. Implements following transformations: rescale, random crop, mirror, four-crop. The output size of the images is 64*64 pixels (this can be changed at the beginning of each function). The transforms are concatenated in the final "apply_transforms" function of the file.

To run it: python classical_data_augmentation.py --inputdir train_reduced --outputdir data/train_classically_augmented


The actual DCGAN code consists of the 4 files main.py, ops.py, utils.py, model.py:
the parameters can be adjusted in the file main.py

-To run it: in training mode: python main.py train_classically_augmented --train
           after training: python main.py --dataset train_classically_augmented

You should make sure that train_classically_augmented/ is in the data/ directory. And that data/ is in your current directory.
As an output: a folder samples/ is created in the current directory: it contains 100 generated files (each of them is a 8*8 grid of 64 images in total). logs/ contains the statistics that can be seen in tensorboard.


-parse_DCGAN_output.py: takes the 100 generated files (each of them is a 8*8 grid of 64 images in total) from the "samples" directory generated by the previous DCGAN algotithm and parses them into 6400 single 64*64 pixel images in the folder "augmented_dataset".

To run it: python parse_DCGAN_output.py

Recap: both data/ and data_info_files/ should be in the current directory.



3)
Classification part: We now use this additional data to see if it increases classification accuracy

-label_csvfile_for_augmenteddata_tobefedto_classifier.py: takes an image folder and outputs a label file with non relevant artist names (irrelevant for our task), style (chosen as input) and file name. It is used to create a label csv file for the data generated by the DCGAN.

To run it: python label_csvfile_for_augmenteddata_tobefedto_classifier.py --inputdir data/augmented_dataset --style='Impressionism' --outcsv_file=labels_for_gan_augmented_data.csv


Classification with Resnet18 architecture: files Resnet18.py, Dataset.py and helper_functions.py

You have to create a "result_files" and a "working_directory" in you current directory. "result_files" will contain the accuracy values for every epoch at the end of the program run. "working_directory" contains the splits in validatio, test set ...

To run it: python Resnet18.py --data_augmentation none [or standard or extra] --resultfile result_ResNet18.csv --datafolder xxx --infofile xxx.csv --datafolder_extra xxx --infofile_extra labels_for_gan_augmented_data.csv



Note about the experiments relative to the paintings:  

First we need to obtain a data file containing only Impressionistic and Realistic images, and the corresponding label file. For this run make_reduced_datafile.py as in 1) but modify the look_for list to ['Realism', Impressionism] before running it. Then run make_subselection_data.py. Let us name the creates folder real_and_imp/ and the file info_real_and_imp.csv
-for Resized: python Resnet18.py --data_augmentation none --resultfile result_ResNet18.csv --datafolder real_and_imp --infofile info_real_and_imp.csv

-for Cropped: same procedure but you have to uncomment line 74 and 121 in Resnet18.py

-Resized+GAN 0,78:  python Resnet18.py --data_augmentation none --resultfile result_ResNet18.csv --datafolder real_and_imp --infofile info_real_and_imp.csv --datafolder_extra augmented_dataset --infofile_extra labels_for_gan_augmented_data.csv

-For other percentages of GAN data you can create a folder and copy a certain amount of data into it. And then run label_csvfile_for_augmenteddata_tobefedto_classifier.py to get a corresponding label csv file, and proceed as before.

-classically augmented: we use a small strick to run it. First split the initial Impressionism + Realism train_reduced/ data file and corresponding label csv file into two files (one for realism and one for Impressionism). To do this, run make_reduced_datafile.py again by modifying the look_for list to ['Realism'] and run it another time by setting the look_for list to ['Impressionism'], in order to get the labels. Then, run make_reduced_datafile.py for every one of the two files. You now have a file with Realism data and a corresponding csv file with the labels (ex: realism/ and info_realism.csv) and the same for Impressionism (ex: impressionism/ and info_impressionism.csv). Note that you don't need to do this procedure to get the Impressionism data if you already did step 1) as step 1) produces this data already.
The last step is now to apply classical data augmentation to the Impressionism file: for this you have to run classical_data_augmentation.py to get a classically augmented impressionism folder and subsequently run label_csvfile_for_augmenteddata_tobefedto_classifier.py with input style impressionism to get the labels file. If these are named respectively classically_augmented_impressionism/ and info_classically_augmented_impressionism.csv you should then type following command for classification:

python Resnet18.py --data_augmentation none --resultfile result_ResNet18.csv --datafolder classically_augmented_impressionism --infofile info_classically_augmented_impressionism.csv --datafolder_extra realism --infofile_extra info_realism.csv



####tester que la deuxieme file totale du readme marche bien



























